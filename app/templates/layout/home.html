{% extends 'layout/base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<!-- üîî MESSAGGI FLASH -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert {{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}
<!-- üîî FINE MESSAGGI FLASH -->

<div class="dashboard">
    <h2>Panoramica</h2>

    <div class="stats-grid">
        <div class="stat-box">
            <h4>üìÇ {{ totale_categorie }}</h4>
            <p>Totale categorie</p>
        </div>

        <div class="stat-box">
            <h4>‚úîÔ∏è {{ categorie_attive }}</h4>
            <p>Categorie attive</p>
        </div>

        <div class="stat-box">
            <h4>‚ùå {{ categorie_non_attive }}</h4>
            <p>Categorie non attive</p>
        </div>

        <div class="stat-box">
            <h4>üìä {{ percentuale_attive }}%</h4>
            <p>Percentuale attive</p>
        </div>
    </div>
</div>
    <section class="hero">
        <h2>Benvenuto</h2>
        <p>Prodotti migliori sul mercato</p>
    </section>
    <div class="section-divider"></div>
    <section style="margin-top: 40px;">
        <h3>üì¶ Prodotti </h3>
        {% if prodotti_da_mostrare %}
        <div style="display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px;">
            {% for prodotto in prodotti_da_mostrare %}
            <a href="{{ url_for('main.dettaglio_prodotto', id=prodotto.id) }}" style="min-width: 180px; background: #f0f4c3; border-radius: 8px; padding: 15px; text-decoration: none; color: inherit; box-shadow: 0 2px 6px rgba(0,0,0,0.1); flex-shrink: 0;">
                <strong>{{ prodotto.nome }}</strong>
                <p>Prezzo: ‚Ç¨{{ prodotto.prezzo }}</p>
                {% if prodotto.attivo %}
                <span style="color: green; font-weight: bold;">(Attivo)</span>
                {% else %}
                <span style="color: red; font-weight: bold;">(Non attivo)</span>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">Nessun prodotto in evidenza al momento.</p>
        {% endif %}
    </section>
    <div class="section-divider"></div>

    <section class="categorie-section">
        <h3>üì¶ Categorie</h3>

        
        

        <!-- Lista categorie -->
        {% if categorie %}
            <ul class="categorie-list">
                {% for cat in categorie %}
                    <li class="category-item">
                        <div class="cat-header">
                            <span class="cat-icon">üìÅ</span>
                            <strong>{{ cat.nome }}</strong>
                            <span class="cat-icon">
                                {% if cat.attiva %}‚úÖ{% else %}‚ùå{% endif %}
                            </span>
                        </div>
                        <p class="cat-desc">{{ cat.descrizione }}</p>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="no-cat">Nessuna categoria presente nel database.</p>
        {% endif %}
    </section>

{% endblock %}